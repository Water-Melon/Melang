### Network

This document introduces a set of functions about TCP and UDP in Melang.



##### mln_tcpConnect

create a TCP connection to server.

```
@mln_tcpConnect(host, service, timeout);
```

Input:

- host - a string value. It can be an IP or domain name.
- service -  a string value. It can be a port number or protocol name, like: http, 80.
- timeout - a millisecond timer. It's an optional argument. It must be an positive integer or zero (timeout immediately). Omit means never timeout.

Return value:

- a TCP socket file descriptor return on success
- *nil* on timed out
- otherwise *false* returned



##### mln_tcpListen

Set up a TCP listen socket.

```
@mln_tcpListen(host, service); 
```

Input:

- host - a string value. It can be an IP or domain name.
- service -  a string value. It can be a port number or protocol name, like: http, 80.

Return value:

- a TCP socket file descriptor return on success, otherwise *false* returned.



##### mln_tcpAccept

Accept a TCP connection.

```
@mln_tcpAccept(listenfd, timeout); 
```

Input:

- listened - an integer value generated by *mln_tcpListen*.
- timeout - a millisecond timer. It's an optional argument. It must be an positive integer or zero (timeout immediately). Omit means never timeout.

Return value:

- a TCP socket file descriptor return on success.
- If *timeout* >= 0 and no TCP arrived, *nil* will be returned.
- Otherwise, *false* returned.



##### mln_tcpSend

Send 'data' via TCP.

```
@mln_tcpSend(sockfd, data); 
```

Input:

- socked - a socket file descriptor which is an integer.
- data - a string value.

Return value:

- *true* returned on success, otherwise *false* returned.



##### mln_tcpRecv

Receive data from TCP.

```
@mln_tcpRecv(sockfd, timeout);  
```

Input:

- sockfd - a socket file descriptor which is an integer.
- timeout - a millisecond timer. It's an optional argument. It must be an positive integer or zero (timeout immediately). Omit means never timeout.

Return value:

- Received data will be returned on success.
- If *timeout* >= 0 and no data arrived, *nil* will be returned.
- Otherwise *false* returned.



##### mln_tcpClose

Close a TCP connection.

```
@mln_tcpClose(sockfd);
```

Input:

- sockfd - a socket file descriptor which is an integer.

Return value:

- Always *nil*.



##### mln_tcpShutdown

Shutdown TCP connection.

```
@mln_tcpShutdown(sockfd, mode); 
```

Input:

- sockfd - a socket file descriptor which is an integer.
- mode - a string and only has two values: *send* and *recv*.

Return value:

- Always *nil*.



##### mln_udpCreate

Create an UDP socket.

```
@mln_udpCreate(host, service);
```

Input:

- host - a string value. It can be an IP or domain name.
- service -  a string value. It can be a port number or protocol name, like: http, 80.

Return value:

- a TCP socket file descriptor return on success, otherwise *false* returned.



##### mln_udpClose

Close an UDP socket.

```
@mln_udpClose(fd);
```

Input:

- fd - an UDP socket file descriptor generated by *mln_udpCreate*.

Return value:

- Always *nil*.



##### mln_udpSend

Send data via UDP.

```
@mln_udpSend(fd, data, host, service); 
```

Input:

- fd. - an UDP socket file descriptor generated by *mln_udpCreate*.
- data - a string value.
- host - a string value. It can be an IP or domain name. This is the destination host.
- service - a string value. It can be a port number or protocol name, like: http, 80. This is the destination service name.

Return value:

- *true* will be returned on success, otherwise *false* returned.



##### mln_udpRecv

Receive data from UDP.

```
@mln_udpRecv(fd, bufsize, &ip, &port, timeout);
```

Input:

- fd - an UDP socket file descriptor generated by *mln_udpCreate*.
- bufsize - an integer indicates the UDP receiving buffer size.
- ip - sender's IP. **This is an output argument**.
- port - sender's port. **This is an output argument**.
- timeout - a millisecond timer. It's an optional argument. It must be an positive integer or zero (timeout immediately). Omit means never timeout.

Return value:

- Received data will be returned on success.
- If *timeout* >= 0 and no data arrived, *nil* will be returned.
- Otherwise *false* returned.



##### Example

```
//client.mln
fd = @mln_tcpConnect('127.0.0.1', '1234');
@mln_print(fd);
@mln_tcpSend(fd, 'Hello');
@mln_print(@mln_tcpRecv(fd));
@mln_tcpClose(fd);
```

```
//server.mln
listenfd = @mln_tcpListen('127.0.0.1', '1234');
connfd = @mln_tcpAccept(listenfd);
@mln_print(@mln_tcpRecv(connfd));
@mln_tcpSend(connfd, 'Hi');
@mln_tcpClose(connfd);
```

```
$ melang server.mln client.mln
```

The output is:

```
10
Hello
Hi
```

